{"version":3,"sources":["../../src/pages/vip/vip.module.ts","../../src/pages/vip/vip.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { VipPage } from './vip';\r\nimport { TranslateModule } from '../../../node_modules/@ngx-translate/core';\r\nimport { Firebase } from '@ionic-native/firebase';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    VipPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(VipPage),\r\n    TranslateModule.forChild()\r\n\r\n    ],providers:[Firebase]\r\n})\r\nexport class VipPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/vip/vip.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, LoadingController, ToastController } from 'ionic-angular';\r\nimport { InAppPurchase2, IAPProduct } from '@ionic-native/in-app-purchase-2';\r\nimport { Platform } from 'ionic-angular';\r\nimport { AuthDataProvider } from '../../providers/auth-data/auth-data';\r\nimport { Product } from '../../models/product-model';\r\nimport { MyApp } from '../../app/app.component';\r\nimport { App } from 'ionic-angular/components/app/app';\r\n// import { GlobalParamesProvider } from '../../providers/global-parames/global-parames';\r\nimport { TrackEventProvider } from '../../providers/track-event/track-event';\r\n\r\n\r\n\r\n\r\n@IonicPage({\r\n  name: \"vip\"\r\n})\r\n@Component({\r\n  selector: 'page-vip',\r\n  templateUrl: 'vip.html',\r\n})\r\nexport class VipPage {\r\n  productMouth: Product\r\n  productYear: Product\r\n\r\n  constructor(\r\n    public authData: AuthDataProvider,\r\n    public platform: Platform,\r\n    public app: App,\r\n    public toastCtrl: ToastController,\r\n    public navCtrl: NavController,\r\n    private store: InAppPurchase2,\r\n    public navParams: NavParams,\r\n    public loadingCtrl: LoadingController,\r\n    // public globalParamesProvider: GlobalParamesProvider,\r\n    public trackEvent: TrackEventProvider\r\n  ) {\r\n    console.log(\"user\", this.authData.user);\r\n\r\n    this.productYear = new Product()\r\n    this.productMouth = new Product()\r\n    let loading = this.loadingCtrl.create()\r\n    loading.present()\r\n\r\n    this.platform.ready().then(() => {\r\n      if(!this.platform.is(\"ios\"))\r\n      this.initializeStore();\r\n      loading.dismiss()\r\n    })\r\n  }\r\n  ionViewDidLoad() {\r\n    console.log(\"ionViewDidLoad vip\");\r\n    this.trackEvent.trackView(\"vip\")\r\n  }\r\n\r\n  goToNotificationpage() {\r\n    this.navCtrl.push(\"notifications\")\r\n  }\r\n\r\n  async initializeStore() {\r\n    this.productMouth.appleProductId = \"interactivecrypto.vip.month\"\r\n    this.productMouth.googleProductId = \"interactivecrypto.vip.month\"\r\n    this.productMouth.name = \"unlimited alerts (1 month)\"\r\n\r\n    this.productYear.appleProductId = \"interactivecrypto.vip.year\"\r\n    this.productYear.googleProductId = \"interactivecrypto.vip.year\"\r\n    this.productYear.name = \"unlimited alerts (1 year)\"\r\n\r\n    if (!this.platform.is('cordova')) { return };\r\n\r\n    this.store.verbosity = this.store.INFO;\r\n    this.store.refresh();\r\n    InAppPurchase2.getPlugin().ready(() => {\r\n      this.store.refresh();\r\n      var productMouth_id = \"\"\r\n      var productYear_id = \"\"\r\n      if (this.platform.is('ios')) {\r\n        productMouth_id = this.productMouth.appleProductId\r\n        productYear_id = this.productYear.appleProductId\r\n      } else {\r\n        productMouth_id = this.productMouth.googleProductId\r\n        productYear_id = this.productYear.googleProductId\r\n      }\r\n      this.store.register({\r\n        id: productMouth_id,\r\n        alias: productMouth_id,\r\n        type: this.store.NON_RENEWING_SUBSCRIPTION\r\n      });\r\n      this.store.register({\r\n        id: productYear_id,\r\n        alias: productYear_id,\r\n        type: this.store.NON_RENEWING_SUBSCRIPTION\r\n      });\r\n\r\n\r\n      this.store.refresh();\r\n      var that = this\r\n      this.store.when(this.productMouth.googleProductId).approved((product: IAPProduct) => {\r\n        product.finish()\r\n        that.authData.user.state = \"approved\";\r\n      })\r\n      this.store.when(this.productYear.appleProductId).approved((product: IAPProduct) => {\r\n        product.finish()\r\n        that.authData.user.state = \"approved\";\r\n      })\r\n\r\n      this.store.when(this.productYear.googleProductId).owned((product: IAPProduct) => {\r\n        product.finish()\r\n        that.authData.user.state = \"approved\";\r\n      })\r\n      this.store.when(this.productMouth.appleProductId).owned((product: IAPProduct) => {\r\n        product.finish()\r\n        that.authData.user.state = \"approved\";\r\n      })\r\n\r\n      this.store.when(this.productMouth.googleProductId).updated(function (product) {\r\n        if (product.state == \"finished\" || product.state == \"owned\" || product.state == \"approved\") {\r\n          that.authData.user.state = \"approved\";\r\n          product.finish();\r\n        }\r\n      });\r\n      this.store.when(this.productMouth.appleProductId).updated(function (product) {\r\n        if (product.state == \"finished\" || product.state == \"owned\" || product.state == \"approved\") {\r\n          that.authData.user.state = \"approved\";\r\n          product.finish();\r\n        }\r\n      });\r\n    })\r\n  }\r\n\r\n  async restorepurchase(productId) {\r\n    if(this.platform.is('ios')){\r\n      this.toastCtrl.create({\r\n        message: \"coming soon.\",\r\n        duration: 4000\r\n      }).present()\r\n      return}\r\n    console.log(\"restorepurchase\");\r\n    this.store.refresh();\r\n    InAppPurchase2.getPlugin().ready(() => {\r\n      console.log(\"getPlugin\");\r\n      this.store.refresh();\r\n      this.store.order(productId).then(() => {\r\n        console.log(\"order\");\r\n        var that = this\r\n        this.store.refresh();\r\n\r\n        this.store.when(productId).updated(function (product) {\r\n          console.log(\"updated\");\r\n\r\n          if (product.state == \"finished\" || product.state == \"owned\" || product.state == \"approved\") {\r\n            console.log(\"finished\");\r\n            window['plugins'].appsFlyer.trackEvent(\"subscribtion\", {\r\n              product: productId,\r\n              user_id: that.authData.user._id\r\n            });\r\n            product.finish();\r\n            that.authData.user.state = \"approved\";\r\n\r\n            that.authData.updateIdOneSignals().then(() => {\r\n              console.log(\"avi1\");\r\n            }).catch(() => {\r\n              console.log(\"avi2\");\r\n            })\r\n          }\r\n\r\n        });\r\n\r\n      })\r\n    })\r\n    this.store.refresh();\r\n\r\n\r\n\r\n  }\r\n  ionViewDidLeave() {\r\n    // this.app.getRootNav().setRoot(MyApp);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/vip/vip.ts"],"sourceRoot":""}